{"ast":null,"code":"module.exports = function (Chart) {\n  var chartHelpers = Chart.helpers;\n\n  var helpers = require('./helpers.js')(Chart);\n\n  var events = require('./events.js')(Chart);\n\n  var annotationTypes = Chart.Annotation.types;\n\n  function setAfterDataLimitsHook(axisOptions) {\n    helpers.decorate(axisOptions, 'afterDataLimits', function (previous, scale) {\n      if (previous) previous(scale);\n      helpers.adjustScaleRange(scale);\n    });\n  }\n\n  function draw(drawTime) {\n    return function (chartInstance, easingDecimal) {\n      var defaultDrawTime = chartInstance.annotation.options.drawTime;\n      helpers.elements(chartInstance).filter(function (element) {\n        return drawTime === (element.options.drawTime || defaultDrawTime);\n      }).forEach(function (element) {\n        element.transition(easingDecimal).draw();\n      });\n    };\n  }\n\n  return {\n    beforeInit: function (chartInstance) {\n      var chartOptions = chartInstance.options; // Initialize chart instance plugin namespace\n\n      var ns = chartInstance.annotation = {\n        elements: {},\n        options: helpers.initConfig(chartOptions.annotation || {}),\n        onDestroy: [],\n        firstRun: true,\n        supported: false\n      }; // Add the annotation scale adjuster to each scale's afterDataLimits hook\n\n      chartInstance.ensureScalesHaveIDs();\n\n      if (chartOptions.scales) {\n        ns.supported = true;\n        chartHelpers.each(chartOptions.scales.xAxes, setAfterDataLimitsHook);\n        chartHelpers.each(chartOptions.scales.yAxes, setAfterDataLimitsHook);\n      }\n    },\n    beforeUpdate: function (chartInstance) {\n      var ns = chartInstance.annotation;\n\n      if (!ns.supported) {\n        return;\n      }\n\n      if (!ns.firstRun) {\n        ns.options = helpers.initConfig(chartInstance.options.annotation || {});\n      } else {\n        ns.firstRun = false;\n      }\n\n      var elementIds = []; // Add new elements, or update existing ones\n\n      ns.options.annotations.forEach(function (annotation) {\n        var id = annotation.id || helpers.objectId(); // No element with that ID exists, and it's a valid annotation type\n\n        if (!ns.elements[id] && annotationTypes[annotation.type]) {\n          var cls = annotationTypes[annotation.type];\n          var element = new cls({\n            id: id,\n            options: annotation,\n            chartInstance: chartInstance\n          });\n          element.initialize();\n          ns.elements[id] = element;\n          annotation.id = id;\n          elementIds.push(id);\n        } else if (ns.elements[id]) {\n          // Nothing to do for update, since the element config references\n          // the same object that exists in the chart annotation config\n          elementIds.push(id);\n        }\n      }); // Delete removed elements\n\n      Object.keys(ns.elements).forEach(function (id) {\n        if (elementIds.indexOf(id) === -1) {\n          ns.elements[id].destroy();\n          delete ns.elements[id];\n        }\n      });\n    },\n    afterScaleUpdate: function (chartInstance) {\n      helpers.elements(chartInstance).forEach(function (element) {\n        element.configure();\n      });\n    },\n    beforeDatasetsDraw: draw('beforeDatasetsDraw'),\n    afterDatasetsDraw: draw('afterDatasetsDraw'),\n    afterDraw: draw('afterDraw'),\n    afterInit: function (chartInstance) {\n      // Detect and intercept events that happen on an annotation element\n      var watchFor = chartInstance.annotation.options.events;\n\n      if (chartHelpers.isArray(watchFor) && watchFor.length > 0) {\n        var canvas = chartInstance.chart.canvas;\n        var eventHandler = events.dispatcher.bind(chartInstance);\n        events.collapseHoverEvents(watchFor).forEach(function (eventName) {\n          chartHelpers.addEvent(canvas, eventName, eventHandler);\n          chartInstance.annotation.onDestroy.push(function () {\n            chartHelpers.removeEvent(canvas, eventName, eventHandler);\n          });\n        });\n      }\n    },\n    destroy: function (chartInstance) {\n      var deregisterers = chartInstance.annotation.onDestroy;\n\n      while (deregisterers.length > 0) {\n        deregisterers.pop()();\n      }\n    }\n  };\n};","map":{"version":3,"sources":["/Users/james/Documents/CODE/greenkode-dashboard/frontend/greenkode/node_modules/chartjs-plugin-annotation/src/annotation.js"],"names":["module","exports","Chart","chartHelpers","helpers","require","events","annotationTypes","Annotation","types","setAfterDataLimitsHook","axisOptions","decorate","previous","scale","adjustScaleRange","draw","drawTime","chartInstance","easingDecimal","defaultDrawTime","annotation","options","elements","filter","element","forEach","transition","beforeInit","chartOptions","ns","initConfig","onDestroy","firstRun","supported","ensureScalesHaveIDs","scales","each","xAxes","yAxes","beforeUpdate","elementIds","annotations","id","objectId","type","cls","initialize","push","Object","keys","indexOf","destroy","afterScaleUpdate","configure","beforeDatasetsDraw","afterDatasetsDraw","afterDraw","afterInit","watchFor","isArray","length","canvas","chart","eventHandler","dispatcher","bind","collapseHoverEvents","eventName","addEvent","removeEvent","deregisterers","pop"],"mappings":"AAAAA,MAAM,CAACC,OAAP,GAAiB,UAASC,KAAT,EAAgB;AAChC,MAAIC,YAAY,GAAGD,KAAK,CAACE,OAAzB;;AAEA,MAAIA,OAAO,GAAGC,OAAO,CAAC,cAAD,CAAP,CAAwBH,KAAxB,CAAd;;AACA,MAAII,MAAM,GAAGD,OAAO,CAAC,aAAD,CAAP,CAAuBH,KAAvB,CAAb;;AAEA,MAAIK,eAAe,GAAGL,KAAK,CAACM,UAAN,CAAiBC,KAAvC;;AAEA,WAASC,sBAAT,CAAgCC,WAAhC,EAA6C;AAC5CP,IAAAA,OAAO,CAACQ,QAAR,CAAiBD,WAAjB,EAA8B,iBAA9B,EAAiD,UAASE,QAAT,EAAmBC,KAAnB,EAA0B;AAC1E,UAAID,QAAJ,EAAcA,QAAQ,CAACC,KAAD,CAAR;AACdV,MAAAA,OAAO,CAACW,gBAAR,CAAyBD,KAAzB;AACA,KAHD;AAIA;;AAED,WAASE,IAAT,CAAcC,QAAd,EAAwB;AACvB,WAAO,UAASC,aAAT,EAAwBC,aAAxB,EAAuC;AAC7C,UAAIC,eAAe,GAAGF,aAAa,CAACG,UAAd,CAAyBC,OAAzB,CAAiCL,QAAvD;AAEAb,MAAAA,OAAO,CAACmB,QAAR,CAAiBL,aAAjB,EACEM,MADF,CACS,UAASC,OAAT,EAAkB;AACzB,eAAOR,QAAQ,MAAMQ,OAAO,CAACH,OAAR,CAAgBL,QAAhB,IAA4BG,eAAlC,CAAf;AACA,OAHF,EAIEM,OAJF,CAIU,UAASD,OAAT,EAAkB;AAC1BA,QAAAA,OAAO,CAACE,UAAR,CAAmBR,aAAnB,EAAkCH,IAAlC;AACA,OANF;AAOA,KAVD;AAWA;;AAED,SAAO;AACNY,IAAAA,UAAU,EAAE,UAASV,aAAT,EAAwB;AACnC,UAAIW,YAAY,GAAGX,aAAa,CAACI,OAAjC,CADmC,CAGnC;;AACA,UAAIQ,EAAE,GAAGZ,aAAa,CAACG,UAAd,GAA2B;AACnCE,QAAAA,QAAQ,EAAE,EADyB;AAEnCD,QAAAA,OAAO,EAAElB,OAAO,CAAC2B,UAAR,CAAmBF,YAAY,CAACR,UAAb,IAA2B,EAA9C,CAF0B;AAGnCW,QAAAA,SAAS,EAAE,EAHwB;AAInCC,QAAAA,QAAQ,EAAE,IAJyB;AAKnCC,QAAAA,SAAS,EAAE;AALwB,OAApC,CAJmC,CAYnC;;AACAhB,MAAAA,aAAa,CAACiB,mBAAd;;AACA,UAAIN,YAAY,CAACO,MAAjB,EAAyB;AACxBN,QAAAA,EAAE,CAACI,SAAH,GAAe,IAAf;AACA/B,QAAAA,YAAY,CAACkC,IAAb,CAAkBR,YAAY,CAACO,MAAb,CAAoBE,KAAtC,EAA6C5B,sBAA7C;AACAP,QAAAA,YAAY,CAACkC,IAAb,CAAkBR,YAAY,CAACO,MAAb,CAAoBG,KAAtC,EAA6C7B,sBAA7C;AACA;AACD,KApBK;AAqBN8B,IAAAA,YAAY,EAAE,UAAStB,aAAT,EAAwB;AACrC,UAAIY,EAAE,GAAGZ,aAAa,CAACG,UAAvB;;AAEA,UAAI,CAACS,EAAE,CAACI,SAAR,EAAmB;AAClB;AACA;;AAED,UAAI,CAACJ,EAAE,CAACG,QAAR,EAAkB;AACjBH,QAAAA,EAAE,CAACR,OAAH,GAAalB,OAAO,CAAC2B,UAAR,CAAmBb,aAAa,CAACI,OAAd,CAAsBD,UAAtB,IAAoC,EAAvD,CAAb;AACA,OAFD,MAEO;AACNS,QAAAA,EAAE,CAACG,QAAH,GAAc,KAAd;AACA;;AAED,UAAIQ,UAAU,GAAG,EAAjB,CAbqC,CAerC;;AACAX,MAAAA,EAAE,CAACR,OAAH,CAAWoB,WAAX,CAAuBhB,OAAvB,CAA+B,UAASL,UAAT,EAAqB;AACnD,YAAIsB,EAAE,GAAGtB,UAAU,CAACsB,EAAX,IAAiBvC,OAAO,CAACwC,QAAR,EAA1B,CADmD,CAGnD;;AACA,YAAI,CAACd,EAAE,CAACP,QAAH,CAAYoB,EAAZ,CAAD,IAAoBpC,eAAe,CAACc,UAAU,CAACwB,IAAZ,CAAvC,EAA0D;AACzD,cAAIC,GAAG,GAAGvC,eAAe,CAACc,UAAU,CAACwB,IAAZ,CAAzB;AACA,cAAIpB,OAAO,GAAG,IAAIqB,GAAJ,CAAQ;AACrBH,YAAAA,EAAE,EAAEA,EADiB;AAErBrB,YAAAA,OAAO,EAAED,UAFY;AAGrBH,YAAAA,aAAa,EAAEA;AAHM,WAAR,CAAd;AAKAO,UAAAA,OAAO,CAACsB,UAAR;AACAjB,UAAAA,EAAE,CAACP,QAAH,CAAYoB,EAAZ,IAAkBlB,OAAlB;AACAJ,UAAAA,UAAU,CAACsB,EAAX,GAAgBA,EAAhB;AACAF,UAAAA,UAAU,CAACO,IAAX,CAAgBL,EAAhB;AACA,SAXD,MAWO,IAAIb,EAAE,CAACP,QAAH,CAAYoB,EAAZ,CAAJ,EAAqB;AAC3B;AACA;AACAF,UAAAA,UAAU,CAACO,IAAX,CAAgBL,EAAhB;AACA;AACD,OApBD,EAhBqC,CAsCrC;;AACAM,MAAAA,MAAM,CAACC,IAAP,CAAYpB,EAAE,CAACP,QAAf,EAAyBG,OAAzB,CAAiC,UAASiB,EAAT,EAAa;AAC7C,YAAIF,UAAU,CAACU,OAAX,CAAmBR,EAAnB,MAA2B,CAAC,CAAhC,EAAmC;AAClCb,UAAAA,EAAE,CAACP,QAAH,CAAYoB,EAAZ,EAAgBS,OAAhB;AACA,iBAAOtB,EAAE,CAACP,QAAH,CAAYoB,EAAZ,CAAP;AACA;AACD,OALD;AAMA,KAlEK;AAmENU,IAAAA,gBAAgB,EAAE,UAASnC,aAAT,EAAwB;AACzCd,MAAAA,OAAO,CAACmB,QAAR,CAAiBL,aAAjB,EAAgCQ,OAAhC,CAAwC,UAASD,OAAT,EAAkB;AACzDA,QAAAA,OAAO,CAAC6B,SAAR;AACA,OAFD;AAGA,KAvEK;AAwENC,IAAAA,kBAAkB,EAAEvC,IAAI,CAAC,oBAAD,CAxElB;AAyENwC,IAAAA,iBAAiB,EAAExC,IAAI,CAAC,mBAAD,CAzEjB;AA0ENyC,IAAAA,SAAS,EAAEzC,IAAI,CAAC,WAAD,CA1ET;AA2EN0C,IAAAA,SAAS,EAAE,UAASxC,aAAT,EAAwB;AAClC;AACA,UAAIyC,QAAQ,GAAGzC,aAAa,CAACG,UAAd,CAAyBC,OAAzB,CAAiChB,MAAhD;;AACA,UAAIH,YAAY,CAACyD,OAAb,CAAqBD,QAArB,KAAkCA,QAAQ,CAACE,MAAT,GAAkB,CAAxD,EAA2D;AAC1D,YAAIC,MAAM,GAAG5C,aAAa,CAAC6C,KAAd,CAAoBD,MAAjC;AACA,YAAIE,YAAY,GAAG1D,MAAM,CAAC2D,UAAP,CAAkBC,IAAlB,CAAuBhD,aAAvB,CAAnB;AACAZ,QAAAA,MAAM,CAAC6D,mBAAP,CAA2BR,QAA3B,EAAqCjC,OAArC,CAA6C,UAAS0C,SAAT,EAAoB;AAChEjE,UAAAA,YAAY,CAACkE,QAAb,CAAsBP,MAAtB,EAA8BM,SAA9B,EAAyCJ,YAAzC;AACA9C,UAAAA,aAAa,CAACG,UAAd,CAAyBW,SAAzB,CAAmCgB,IAAnC,CAAwC,YAAW;AAClD7C,YAAAA,YAAY,CAACmE,WAAb,CAAyBR,MAAzB,EAAiCM,SAAjC,EAA4CJ,YAA5C;AACA,WAFD;AAGA,SALD;AAMA;AACD,KAxFK;AAyFNZ,IAAAA,OAAO,EAAE,UAASlC,aAAT,EAAwB;AAChC,UAAIqD,aAAa,GAAGrD,aAAa,CAACG,UAAd,CAAyBW,SAA7C;;AACA,aAAOuC,aAAa,CAACV,MAAd,GAAuB,CAA9B,EAAiC;AAChCU,QAAAA,aAAa,CAACC,GAAd;AACA;AACD;AA9FK,GAAP;AAgGA,CA7HD","sourcesContent":["module.exports = function(Chart) {\n\tvar chartHelpers = Chart.helpers;\n\n\tvar helpers = require('./helpers.js')(Chart);\n\tvar events = require('./events.js')(Chart);\n\n\tvar annotationTypes = Chart.Annotation.types;\n\n\tfunction setAfterDataLimitsHook(axisOptions) {\n\t\thelpers.decorate(axisOptions, 'afterDataLimits', function(previous, scale) {\n\t\t\tif (previous) previous(scale);\n\t\t\thelpers.adjustScaleRange(scale);\n\t\t});\n\t}\n\n\tfunction draw(drawTime) {\n\t\treturn function(chartInstance, easingDecimal) {\n\t\t\tvar defaultDrawTime = chartInstance.annotation.options.drawTime;\n\n\t\t\thelpers.elements(chartInstance)\n\t\t\t\t.filter(function(element) {\n\t\t\t\t\treturn drawTime === (element.options.drawTime || defaultDrawTime);\n\t\t\t\t})\n\t\t\t\t.forEach(function(element) {\n\t\t\t\t\telement.transition(easingDecimal).draw();\n\t\t\t\t});\n\t\t};\n\t}\n\n\treturn {\n\t\tbeforeInit: function(chartInstance) {\n\t\t\tvar chartOptions = chartInstance.options;\n\n\t\t\t// Initialize chart instance plugin namespace\n\t\t\tvar ns = chartInstance.annotation = {\n\t\t\t\telements: {},\n\t\t\t\toptions: helpers.initConfig(chartOptions.annotation || {}),\n\t\t\t\tonDestroy: [],\n\t\t\t\tfirstRun: true,\n\t\t\t\tsupported: false\n\t\t\t};\n\n\t\t\t// Add the annotation scale adjuster to each scale's afterDataLimits hook\n\t\t\tchartInstance.ensureScalesHaveIDs();\n\t\t\tif (chartOptions.scales) {\n\t\t\t\tns.supported = true;\n\t\t\t\tchartHelpers.each(chartOptions.scales.xAxes, setAfterDataLimitsHook);\n\t\t\t\tchartHelpers.each(chartOptions.scales.yAxes, setAfterDataLimitsHook);\n\t\t\t}\n\t\t},\n\t\tbeforeUpdate: function(chartInstance) {\n\t\t\tvar ns = chartInstance.annotation;\n\n\t\t\tif (!ns.supported) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!ns.firstRun) {\n\t\t\t\tns.options = helpers.initConfig(chartInstance.options.annotation || {});\n\t\t\t} else {\n\t\t\t\tns.firstRun = false;\n\t\t\t}\n\n\t\t\tvar elementIds = [];\n\n\t\t\t// Add new elements, or update existing ones\n\t\t\tns.options.annotations.forEach(function(annotation) {\n\t\t\t\tvar id = annotation.id || helpers.objectId();\n\t\t\t\t\n\t\t\t\t// No element with that ID exists, and it's a valid annotation type\n\t\t\t\tif (!ns.elements[id] && annotationTypes[annotation.type]) {\n\t\t\t\t\tvar cls = annotationTypes[annotation.type];\n\t\t\t\t\tvar element = new cls({\n\t\t\t\t\t\tid: id,\n\t\t\t\t\t\toptions: annotation,\n\t\t\t\t\t\tchartInstance: chartInstance,\n\t\t\t\t\t});\n\t\t\t\t\telement.initialize();\n\t\t\t\t\tns.elements[id] = element;\n\t\t\t\t\tannotation.id = id;\n\t\t\t\t\telementIds.push(id);\n\t\t\t\t} else if (ns.elements[id]) {\n\t\t\t\t\t// Nothing to do for update, since the element config references\n\t\t\t\t\t// the same object that exists in the chart annotation config\n\t\t\t\t\telementIds.push(id);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Delete removed elements\n\t\t\tObject.keys(ns.elements).forEach(function(id) {\n\t\t\t\tif (elementIds.indexOf(id) === -1) {\n\t\t\t\t\tns.elements[id].destroy();\n\t\t\t\t\tdelete ns.elements[id];\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tafterScaleUpdate: function(chartInstance) {\n\t\t\thelpers.elements(chartInstance).forEach(function(element) {\n\t\t\t\telement.configure();\n\t\t\t});\n\t\t},\n\t\tbeforeDatasetsDraw: draw('beforeDatasetsDraw'),\n\t\tafterDatasetsDraw: draw('afterDatasetsDraw'),\n\t\tafterDraw: draw('afterDraw'),\n\t\tafterInit: function(chartInstance) {\n\t\t\t// Detect and intercept events that happen on an annotation element\n\t\t\tvar watchFor = chartInstance.annotation.options.events;\n\t\t\tif (chartHelpers.isArray(watchFor) && watchFor.length > 0) {\n\t\t\t\tvar canvas = chartInstance.chart.canvas;\n\t\t\t\tvar eventHandler = events.dispatcher.bind(chartInstance);\n\t\t\t\tevents.collapseHoverEvents(watchFor).forEach(function(eventName) {\n\t\t\t\t\tchartHelpers.addEvent(canvas, eventName, eventHandler);\n\t\t\t\t\tchartInstance.annotation.onDestroy.push(function() {\n\t\t\t\t\t\tchartHelpers.removeEvent(canvas, eventName, eventHandler);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tdestroy: function(chartInstance) {\n\t\t\tvar deregisterers = chartInstance.annotation.onDestroy;\n\t\t\twhile (deregisterers.length > 0) {\n\t\t\t\tderegisterers.pop()();\n\t\t\t}\n\t\t}\n\t};\n};\n"]},"metadata":{},"sourceType":"script"}